(function(e,E){typeof exports=="object"&&typeof module<"u"?module.exports=E(require("vue")):typeof define=="function"&&define.amd?define(["vue"],E):(e=typeof globalThis<"u"?globalThis:e||self,e.ScubaCoderChatPanel=E(e.Vue))})(this,function(e){"use strict";const E={class:"message-header"},$={class:"role-badge"},P={class:"timestamp"},D={class:"message-content"},L={key:0,class:"loading-indicator"},I=["innerHTML"],T={key:0,class:"message-actions"},A=e.defineComponent({__name:"MessageCard",props:{message:{},isLoading:{type:Boolean}},emits:["insert-code"],setup(a,{emit:_}){const l=a,r=_,c=e.computed(()=>l.message.content.includes("```")),p=n=>n.toLocaleTimeString(),m=n=>n.replace(/```(\w+)?\n([\s\S]*?)```/g,(i,t,o)=>`<div class="code-block">
        <div class="code-header">${t||"text"}</div>
        <pre class="code-content" data-code="${encodeURIComponent(o.trim())}">${o.trim()}</pre>
      </div>`).replace(/`([^`]+)`/g,'<code class="inline-code">$1</code>'),h=()=>{const n=document.querySelectorAll(".code-content");if(n.length>0){const i=Array.from(n).map(t=>t.textContent).join(`

`);navigator.clipboard.writeText(i).then(()=>{console.log("Code copied to clipboard")})}},g=()=>{const n=document.querySelectorAll(".code-content");if(n.length>0){const i=Array.from(n).map(t=>t.textContent).join(`

`);r("insert-code",i)}};return(n,i)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["message-card",[`role-${n.message.role}`,{loading:n.isLoading}]])},[e.createElementVNode("div",E,[e.createElementVNode("div",$,e.toDisplayString(n.message.role==="user"?"User":"Assistant"),1),e.createElementVNode("div",P,e.toDisplayString(p(n.message.timestamp)),1)]),e.createElementVNode("div",D,[n.message.role==="assistant"&&n.isLoading?(e.openBlock(),e.createElementBlock("div",L,[...i[0]||(i[0]=[e.createElementVNode("div",{class:"typing-dots"},[e.createElementVNode("span"),e.createElementVNode("span"),e.createElementVNode("span")],-1)])])):(e.openBlock(),e.createElementBlock("div",{key:1,class:"content-text",innerHTML:m(n.message.content)},null,8,I))]),n.message.role==="assistant"&&!n.isLoading?(e.openBlock(),e.createElementBlock("div",T,[c.value?(e.openBlock(),e.createElementBlock("button",{key:0,onClick:h,class:"action-btn",title:"Copy code"}," ðŸ“‹ Copy ")):e.createCommentVNode("",!0),c.value?(e.openBlock(),e.createElementBlock("button",{key:1,onClick:g,class:"action-btn",title:"Insert into editor"}," âž• Insert ")):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)],2))}}),Se="",y=(a,_)=>{const l=a.__vccOpts||a;for(const[r,c]of _)l[r]=c;return l},S=y(A,[["__scopeId","data-v-a87faf0c"]]),F={class:"context-pills"},U={class:"pills-header"},v={key:0,class:"selected-count"},z={class:"pills-container"},H=["onClick","title"],O={key:0,class:"checkmark"},j={key:0,class:"no-files",disabled:""},q={class:"pills-actions"},K=e.defineComponent({__name:"ContextPills",props:{availableFiles:{},selectedUris:{}},emits:["toggle-file","add-context","clear-selection"],setup(a,{emit:_}){const l=a,r=_,c=e.computed(()=>l.selectedUris.length),p=g=>{r("toggle-file",g)},m=()=>{r("add-context")},h=()=>{r("clear-selection")};return(g,n)=>(e.openBlock(),e.createElementBlock("div",F,[e.createElementVNode("div",U,[n[0]||(n[0]=e.createElementVNode("span",{class:"pills-title"},"Context Files",-1)),c.value>0?(e.openBlock(),e.createElementBlock("span",v,e.toDisplayString(c.value)+" selected",1)):e.createCommentVNode("",!0)]),e.createElementVNode("div",z,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(g.availableFiles,i=>(e.openBlock(),e.createElementBlock("button",{key:i.uri,class:e.normalizeClass(["context-pill",{active:i.isSelected}]),onClick:t=>p(i.uri),title:i.label},[e.createTextVNode(e.toDisplayString(i.label)+" ",1),i.isSelected?(e.openBlock(),e.createElementBlock("span",O,"âœ“")):e.createCommentVNode("",!0)],10,H))),128)),g.availableFiles.length===0?(e.openBlock(),e.createElementBlock("button",j," No context files available ")):e.createCommentVNode("",!0)]),e.createElementVNode("div",q,[e.createElementVNode("button",{onClick:m,class:"add-context-btn",title:"Add more context files"}," âž• Add Context "),c.value>0?(e.openBlock(),e.createElementBlock("button",{key:0,onClick:h,class:"clear-btn",title:"Clear all selections"}," ðŸ—‘ï¸ Clear ")):e.createCommentVNode("",!0)])]))}}),Me="",R=y(K,[["__scopeId","data-v-945ce016"]]),W={class:"provider-selector"},G={class:"selector-header"},J={class:"current-provider"},Q=["title"],X={class:"provider-info"},Y={class:"provider-name"},Z={class:"model-name"},ee={key:0,class:"dropdown-content"},te={class:"provider-groups"},oe={class:"group-header"},ne={class:"group-models"},se=["onClick"],le={class:"model-name"},ae={key:0,class:"checkmark"},ce={key:0,class:"no-models"},re=e.defineComponent({__name:"ProviderSelector",props:{availableModels:{},currentProvider:{},currentModel:{}},emits:["change-provider-model"],setup(a,{emit:_}){const l=a,r=_,c=e.ref(!1),p=e.computed(()=>{const t={};return l.availableModels.forEach(o=>{t[o.provider]||(t[o.provider]=[]),t[o.provider].push(o)}),Object.entries(t).map(([o,f])=>({provider:o,models:f.sort((k,u)=>k.model.localeCompare(u.model))}))}),m=(t,o)=>t===l.currentProvider&&o===l.currentModel,h=()=>{c.value=!c.value},g=()=>{c.value=!1},n=(t,o)=>{r("change-provider-model",t,o),g()},i=t=>{t.target.closest(".provider-selector")||g()};return e.onMounted(()=>{document.addEventListener("click",i)}),e.onUnmounted(()=>{document.removeEventListener("click",i)}),(t,o)=>(e.openBlock(),e.createElementBlock("div",W,[e.createElementVNode("div",G,[o[0]||(o[0]=e.createElementVNode("span",{class:"selector-title"},"AI Provider",-1)),e.createElementVNode("span",J,e.toDisplayString(t.currentProvider)+" â€¢ "+e.toDisplayString(t.currentModel),1)]),e.createElementVNode("div",{class:e.normalizeClass(["selector-dropdown",{open:c.value}])},[e.createElementVNode("button",{onClick:h,class:"selector-button",title:`Current: ${t.currentProvider} â€¢ ${t.currentModel}`},[e.createElementVNode("span",X,[e.createElementVNode("span",Y,e.toDisplayString(t.currentProvider),1),e.createElementVNode("span",Z,e.toDisplayString(t.currentModel),1)]),o[1]||(o[1]=e.createElementVNode("span",{class:"dropdown-arrow"},"â–¼",-1))],8,Q),c.value?(e.openBlock(),e.createElementBlock("div",ee,[e.createElementVNode("div",{class:"dropdown-header"},[o[2]||(o[2]=e.createElementVNode("span",null,"Select Provider & Model",-1)),e.createElementVNode("button",{onClick:g,class:"close-btn"},"Ã—")]),e.createElementVNode("div",te,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.value,f=>(e.openBlock(),e.createElementBlock("div",{key:f.provider,class:"provider-group"},[e.createElementVNode("div",oe,e.toDisplayString(f.provider),1),e.createElementVNode("div",ne,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(f.models,k=>(e.openBlock(),e.createElementBlock("button",{key:`${f.provider}-${k.model}`,class:e.normalizeClass(["model-option",{active:m(f.provider,k.model)}]),onClick:u=>n(f.provider,k.model)},[e.createElementVNode("span",le,e.toDisplayString(k.model),1),m(f.provider,k.model)?(e.openBlock(),e.createElementBlock("span",ae,"âœ“")):e.createCommentVNode("",!0)],10,se))),128))])]))),128))]),t.availableModels.length===0?(e.openBlock(),e.createElementBlock("div",ce," No provider models available ")):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)],2),o[3]||(o[3]=e.createElementVNode("div",{class:"provider-info"},[e.createElementVNode("span",{class:"info-text"},"No code leaves your machine")],-1))]))}}),$e="",ie=y(re,[["__scopeId","data-v-15970ce8"]]),de={class:"chat-composer"},pe={class:"composer-header"},me={key:0,class:"context-indicator"},ge={class:"input-container"},_e=["disabled"],he={class:"input-actions"},fe=["disabled"],ke={key:0},Ce={key:1,class:"loading-spinner"},ue={class:"input-tips"},Ee={key:0,class:"tip context-tip"},ye=e.defineComponent({__name:"ChatComposer",props:{isLoading:{type:Boolean},hasContext:{type:Boolean},contextCount:{}},emits:["send-message"],setup(a,{emit:_}){const l=a,r=_,c=e.ref(""),p=e.ref(),m=e.computed(()=>c.value.trim().length>0&&!l.isLoading),h=t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),n())},g=()=>{p.value&&(p.value.style.height="auto",p.value.style.height=Math.min(p.value.scrollHeight,200)+"px")},n=()=>{const t=c.value.trim();!t||!m.value||(r("send-message",t),c.value="",e.nextTick(()=>{p.value&&(p.value.style.height="auto")}))},i=()=>{e.nextTick(()=>{p.value&&p.value.focus()})};return e.watch(()=>l.isLoading,(t,o)=>{o&&!t&&i()}),i(),(t,o)=>(e.openBlock(),e.createElementBlock("div",de,[e.createElementVNode("div",pe,[o[1]||(o[1]=e.createElementVNode("span",{class:"composer-title"},"Ask ScubaCoder",-1)),t.hasContext?(e.openBlock(),e.createElementBlock("span",me,e.toDisplayString(t.contextCount)+" context file"+e.toDisplayString(t.contextCount!==1?"s":"")+" selected ",1)):e.createCommentVNode("",!0)]),e.createElementVNode("div",ge,[e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":o[0]||(o[0]=f=>c.value=f),onKeydown:h,onInput:g,placeholder:"Ask a question about your codebase... (Shift+Enter = newline)",class:"chat-input",disabled:t.isLoading,ref_key:"inputRef",ref:p},null,40,_e),[[e.vModelText,c.value]]),e.createElementVNode("div",he,[e.createElementVNode("button",{onClick:n,disabled:!m.value||t.isLoading,class:e.normalizeClass(["send-button",{loading:t.isLoading}])},[t.isLoading?(e.openBlock(),e.createElementBlock("span",Ce,"â³")):(e.openBlock(),e.createElementBlock("span",ke,"Send"))],10,fe),e.createElementVNode("div",ue,[o[2]||(o[2]=e.createElementVNode("span",{class:"tip"},"Shift+Enter for new line",-1)),t.hasContext?(e.openBlock(),e.createElementBlock("span",Ee," Context files will be included ")):e.createCommentVNode("",!0)])])])]))}}),Pe="",Ve=y(ye,[["__scopeId","data-v-cde4467d"]]);function be(){const a=e.ref(!1),_=()=>{a.value=typeof window<"u"&&"vscode"in window},l=m=>{a.value&&window.vscode?window.vscode.postMessage(m):console.log("VSCode message (dev mode):",m)},r=m=>{const h=g=>{g.data&&typeof g.data=="object"&&m(g.data)};return window.addEventListener("message",h),()=>{window.removeEventListener("message",h)}},c=()=>a.value&&window.vscode?window.vscode.getState():null,p=m=>{a.value&&window.vscode&&window.vscode.setState(m)};return e.onMounted(()=>{_()}),{isVSCode:a,postMessage:l,onMessage:r,getState:c,setState:p}}function Be(){const{postMessage:a,onMessage:_}=be(),l=e.ref([]),r=e.ref([]),c=e.ref([]),p=e.ref([]),m=e.ref(""),h=e.ref(""),g=e.ref(!1),n=e.ref(""),i=e.computed(()=>r.value.length>0),t=e.computed(()=>r.value.length),o=()=>{l.value=[{id:"welcome",role:"assistant",content:"Ask a question about your codebase. Use the context pills below to include files. For example: `How do I open the chat panel?`",timestamp:new Date}]},f=()=>{const d=n.value.trim();if(!d)return;const s={id:Date.now().toString(),role:"user",content:d,timestamp:new Date,contextUris:r.value};l.value.push(s),n.value="",a({type:"chat",text:d,contextUris:r.value})},k=d=>{switch(d.type){case"userMessage":break;case"loading":g.value=!0;break;case"reply":g.value=!1;const s={id:Date.now().toString(),role:"assistant",content:d.text,timestamp:new Date};l.value.push(s);break;case"updateProviderModel":d.provider&&(m.value=d.provider),d.model&&(h.value=d.model);break}},u=d=>{const s=r.value.indexOf(d);s>-1?r.value.splice(s,1):r.value.push(d)},b=(d,s)=>{a({type:"changeProviderModel",provider:d,model:s})},B=d=>{a({type:"insert",code:d})},N=d=>{a({type:"searchWorkspace",query:d})},w=(d,s,C)=>{a({type:"log",level:d,message:s,data:C})},x=_(k);return{messages:l,selectedContextUris:r,availableContextFiles:c,availableProviderModels:p,currentProvider:m,currentModel:h,isLoading:g,inputText:n,hasSelectedContext:i,contextSelectionCount:t,initializeChat:o,sendMessage:f,toggleContextFile:u,changeProviderModel:b,insertCode:B,searchWorkspace:N,logMessage:w,unsubscribe:x}}const Ne={id:"app",class:"chat-panel-app"},we={key:0,class:"loading-message"},xe=e.defineComponent({__name:"App",setup(a){const{messages:_,selectedContextUris:l,availableContextFiles:r,availableProviderModels:c,currentProvider:p,currentModel:m,isLoading:h,initializeChat:g,sendMessage:n,toggleContextFile:i,changeProviderModel:t,insertCode:o,logMessage:f,unsubscribe:k}=Be(),u=e.ref(),b=e.computed(()=>l.value.length>0),B=e.computed(()=>l.value.length),N=s=>{n()},w=()=>{f("info","Add context functionality would be implemented here")},x=()=>{l.value.length=0},d=()=>{e.nextTick(()=>{u.value&&(u.value.scrollTop=u.value.scrollHeight)})};return e.watch(_,()=>{d()},{deep:!0}),e.onMounted(()=>{if(g(),window.vscode)try{const s=window.vscode.getState();s&&s.candidates&&(r.value=s.candidates.map(C=>({label:C.label,uri:C.uri,isSelected:!1}))),s&&s.availableProviderModels&&(c.value=s.availableProviderModels),s&&s.providerId&&(p.value=s.providerId),s&&s.model&&(m.value=s.model)}catch(s){console.warn("Failed to initialize from VSCode state:",s)}e.watch(l,s=>{r.value.forEach(C=>{C.isSelected=s.includes(C.uri)})})}),e.onUnmounted(()=>{k()}),(s,C)=>(e.openBlock(),e.createElementBlock("div",Ne,[C[0]||(C[0]=e.createElementVNode("div",{class:"app-header"},[e.createElementVNode("h1",{class:"app-title"},"ScubaCoder â€” Chat"),e.createElementVNode("div",{class:"app-subtitle"},"AI-powered coding assistant")],-1)),e.createElementVNode("div",{class:"messages-container",ref_key:"messagesContainer",ref:u},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(_),M=>(e.openBlock(),e.createBlock(S,{key:M.id,message:M,"is-loading":!1,onInsertCode:e.unref(o)},null,8,["message","onInsertCode"]))),128)),e.unref(h)?(e.openBlock(),e.createElementBlock("div",we,[e.createVNode(S,{message:{id:"loading",role:"assistant",content:"Thinking...",timestamp:new Date},"is-loading":!0},null,8,["message"])])):e.createCommentVNode("",!0)],512),e.createVNode(R,{"available-files":e.unref(r),"selected-uris":e.unref(l),onToggleFile:e.unref(i),onAddContext:w,onClearSelection:x},null,8,["available-files","selected-uris","onToggleFile"]),e.createVNode(ie,{"available-models":e.unref(c),"current-provider":e.unref(p),"current-model":e.unref(m),onChangeProviderModel:e.unref(t)},null,8,["available-models","current-provider","current-model","onChangeProviderModel"]),e.createVNode(Ve,{"is-loading":e.unref(h),"has-context":b.value,"context-count":B.value,onSendMessage:N},null,8,["is-loading","has-context","context-count"])]))}}),De="",V=e.createApp(xe);return process.env.NODE_ENV==="development"&&(V.config.errorHandler=(a,_,l)=>{console.error("Vue Error:",a),console.error("Component:",_),console.error("Info:",l)}),V.mount("#app"),window.ScubaCoderChatPanel={createApp:a=>(console.log("Vue app initialized with config:",a),V)},V});
